sudo apt-get update
sudo apt-get install -y \
    curl \
    git \
    build-essential \
    nodejs \
    npm \
    rpm \
    golang


curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
sudo apt-get install -y nodejs


node -v   # doit Ãªtre >= 18
npm -v


sudo npm install -g yarn
yarn -v   # doit afficher une version ~1.22.x


sudo apt-get install -y golang
go version


git clone https://github.com/ente-io/ente
cd ente/desktop

yarn install
yarn build


-------

# 1ï¸âƒ£ Aller dans le dossier desktop
cd ~/ente/desktop

# 2ï¸âƒ£ Supprimer les modules et nettoyer le cache
rm -rf node_modules
yarn cache clean

# 3ï¸âƒ£ Supprimer le lock file npm qui peut causer des conflits
rm -f package-lock.json

# 4ï¸âƒ£ CrÃ©er/Ã©diter un .yarnrc pour forcer HTTPS
echo -e '--install.pure-lockfile true\ngit "https://github.com/"' > .yarnrc

# 5ï¸âƒ£ Configurer Git globalement pour remplacer toutes les URL SSH GitHub par HTTPS
git config --global --unset-all url."https://github.com/".insteadOf
git config --global --unset-all url."https://".insteadOf
git config --global url."https://github.com/".insteadOf ssh://git@github.com/
git config --global url."https://github.com/".insteadOf git@github.com:
git config --global url."https://github.com/".insteadOf git://github.com/
# RÃ¨gle spÃ©cifique pour electron/node-gyp
git config --global url."https://github.com/electron/".insteadOf ssh://git@github.com/electron/

# 6ï¸âƒ£ VÃ©rifier la configuration Git
git config --global --get-regexp url

# 7ï¸âƒ£ Lancer lâ€™installation Yarn proprement
yarn install


------ 
Guide rÃ©sumÃ© pour installer Ente Desktop sur Debian 13
1ï¸âƒ£ Installer les dÃ©pendances systÃ¨me
sudo apt update
sudo apt install -y \
    curl \
    git \
    build-essential \
    nodejs \
    npm \
    rpm \
    golang


Node.js doit Ãªtre >=18.

VÃ©rifieâ€¯:

node -v
npm -v
go version


Installer Yarn globalementâ€¯:

sudo npm install -g yarn
yarn -v

2ï¸âƒ£ Cloner le projet Ente
git clone https://github.com/ente-io/ente
cd ente/desktop

3ï¸âƒ£ Configurer Git pour Ã©viter les problÃ¨mes SSH

Certains packages (ex: electron/node-gyp) utilisent SSH par dÃ©faut, ce qui provoque lâ€™erreur Host key verification failed.

# Supprimer anciennes rÃ¨gles conflictuelles
git config --global --unset-all url."https://github.com/".insteadOf
git config --global --unset-all url."https://".insteadOf

# Forcer HTTPS pour GitHub
git config --global url."https://github.com/".insteadOf ssh://git@github.com/
git config --global url."https://github.com/".insteadOf git@github.com:
git config --global url."https://github.com/".insteadOf git://github.com/
# RÃ¨gle spÃ©cifique pour node-gyp / Electron
git config --global url."https://github.com/electron/".insteadOf ssh://git@github.com/electron/


VÃ©rifie la configurationâ€¯:

git config --global --get-regexp url

4ï¸âƒ£ PrÃ©parer Yarn et le projet
# Supprimer les modules et lock files prÃ©cÃ©dents
rm -rf node_modules
rm -f package-lock.json
yarn cache clean

# CrÃ©er un .yarnrc pour forcer HTTPS
echo -e '--install.pure-lockfile true\ngit "https://github.com/"' > .yarnrc

5ï¸âƒ£ Installer les dÃ©pendances via Yarn
yarn install


Cela installe toutes les dÃ©pendances, y compris les modules natifs dâ€™Electron.

Cette Ã©tape peut prendre quelques minutes.

6ï¸âƒ£ Compiler Ente Desktop
yarn build


Cette commande crÃ©e le binaire exÃ©cutable.

Le binaire se trouve gÃ©nÃ©ralement dans le dossier dist/.

7ï¸âƒ£ Lancer Ente Desktop
cd dist
./Ente   # ou le nom exact du fichier gÃ©nÃ©rÃ©


Pour tester en mode dÃ©veloppement (hot reload)â€¯:

yarn dev


---- 

ğŸ”¹ Ce que tu peux faire ensuite

Tester le binaire gÃ©nÃ©rÃ©
AprÃ¨s yarn build, le binaire (exÃ©cutable) se trouve normalement dans le dossier dist/ ou similaire.
Pour le lancerâ€¯:

cd dist
./Ente  # ou le nom exact du fichier gÃ©nÃ©rÃ©


Tu devrais voir lâ€™interface graphique dâ€™Ente sâ€™ouvrir.

Mode dÃ©veloppement (optionnel)
Si tu veux tester avec hot reload (utile pour debug)â€¯:

yarn dev


VÃ©rifier les fonctionnalitÃ©s

CrÃ©er un compte local

Ajouter/importer des photos

VÃ©rifier que les photos sont chiffrÃ©es (bout-en-bout)

Tester lâ€™interface et le menu

Automatiser lâ€™exÃ©cution (si besoin pour ton TP)
Si tu veux lancer Ente Desktop automatiquement ou via un script, tu peux crÃ©er un petit script shellâ€¯:

#!/bin/bash
cd /root/ente/desktop/dist
./Ente


Puis exÃ©cuterâ€¯:

chmod +x start_ente.sh
./start_ente.sh
