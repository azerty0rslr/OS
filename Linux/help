sudo apt-get update
sudo apt-get install -y \
    curl \
    git \
    build-essential \
    nodejs \
    npm \
    rpm \
    golang


curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
sudo apt-get install -y nodejs


node -v   # doit être >= 18
npm -v


sudo npm install -g yarn
yarn -v   # doit afficher une version ~1.22.x


sudo apt-get install -y golang
go version


git clone https://github.com/ente-io/ente
cd ente/desktop

yarn install
yarn build


-------

# 1️⃣ Aller dans le dossier desktop
cd ~/ente/desktop

# 2️⃣ Supprimer les modules et nettoyer le cache
rm -rf node_modules
yarn cache clean

# 3️⃣ Supprimer le lock file npm qui peut causer des conflits
rm -f package-lock.json

# 4️⃣ Créer/éditer un .yarnrc pour forcer HTTPS
echo -e '--install.pure-lockfile true\ngit "https://github.com/"' > .yarnrc

# 5️⃣ Configurer Git globalement pour remplacer toutes les URL SSH GitHub par HTTPS
git config --global --unset-all url."https://github.com/".insteadOf
git config --global --unset-all url."https://".insteadOf
git config --global url."https://github.com/".insteadOf ssh://git@github.com/
git config --global url."https://github.com/".insteadOf git@github.com:
git config --global url."https://github.com/".insteadOf git://github.com/
# Règle spécifique pour electron/node-gyp
git config --global url."https://github.com/electron/".insteadOf ssh://git@github.com/electron/

# 6️⃣ Vérifier la configuration Git
git config --global --get-regexp url

# 7️⃣ Lancer l’installation Yarn proprement
yarn install


------ 

root@vbox:~/ente/desktop# git config --global --unset-all url."https://github.com/".insteadOf
root@vbox:~/ente/desktop# git config --global --unset-all url."https://".insteadOf
root@vbox:~/ente/desktop# git config --global url."https://github.com/".insteadOf ssh://git@github.com/
root@vbox:~/ente/desktop# git config --global url."https://github.com/".insteadOf git@github.com:
root@vbox:~/ente/desktop# git config --global url."https://github.com/".insteadOf git://github.com/
root@vbox:~/ente/desktop# git config --global --get-regexp url
url.https://github.com/.insteadof git://github.com/
root@vbox:~/ente/desktop# yarn cache clean
yarn cache v1.22.22
success Cleared cache.
Done in 1.28s.
root@vbox:~/ente/desktop# rm -rf node_modules
root@vbox:~/ente/desktop# yarn install
yarn install v1.22.22
[1/4] Resolving packages...
[2/4] Fetching packages...
error Command failed.
Exit code: 128
Command: git
Arguments: ls-remote --tags --heads ssh://git@github.com/electron/node-gyp.git
Directory: /root/ente/desktop
Output:
Host key verification failed.
fatal: Could not read from remote repository.

Please make sure you have the correct access rights
and the repository exists.
info Visit https://yarnpkg.com/en/docs/cli/install for documentation about this command.
root@vbox:~/ente/desktop# 
